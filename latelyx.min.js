/**
 * Lately.js 修改版本
 *
 * @name Lately.js修改版本
 * @version 基于原版本 2.5.2
 * @author  alex.xu (原作者:Tokin (Tokinx))
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 *
 * For usage and examples, visit:
 * 原项目地址：https://tokinx.github.io/lately/
 * 修改版本地址：https://github.com/afyi/lately
 * Copyright (c) 2017, biji.io
 */
(() => { window.Lately = new function () { this.lang = { second: "秒", minute: "分钟", hour: "小时", day: "天", month: "个月", year: "年", ago: "前", error: "NaN", yestoday: "昨天", tda: "前天" }; const formatDate = (date, type = 1) => { let year = date.getFullYear(); let month = (date.getMonth() + 1).toString().padStart(2, '0'); let day = date.getDate().toString().padStart(2, '0'); let hours = date.getHours().toString().padStart(2, '0'); let minutes = date.getMinutes().toString().padStart(2, '0'); year = year == (new Date()).getFullYear() ? '' : (year + '/'); return type == 1 ? `${year}${month}/${day}${hours}:${minutes}` : `${hours}:${minutes}`; };const format = (date) => { date = new Date(_val(date)); const diffSeconds = Math.floor(Math.abs(Date.now() - date) / 1000); if (diffSeconds > 60 * 60 * 24) return formatDate(date); const floor = (num, _lang) => Math.floor(num) + _lang, obj = new function () { this.second = (Date.now() - date.getTime()) / 1000; this.minute = this.second / 60; this.hour = this.minute / 60; this.day = this.hour / 24 }, key = Object.keys(obj).reverse().find(_ => obj[_] >= 1); let day = floor(obj[key], this.lang[key]); if (day == '1天') day = this.lang.yestoday; if (day == '2天') day = this.lang.tda; return (key ? day : this.lang.error) + this.lang.ago + (this.day > 0 ? formatDate(date, 2) : '') }, _val = (date) => { date = new Date(date && (typeof date === 'number' ? date : date.replace(/-/g, '/').replace('T', ' '))); return isNaN(date.getTime()) ? false : date.getTime() }; return { init: ({ target = "time", lang } = {}) => { if (lang) this.lang = lang; for (let el of document.querySelectorAll(target)) { const date = _val(el.dateTime) || _val(el.title) || _val(el.innerHTML) || 0; if (!date) return; el.title = new Date(date).toLocaleString(); el.innerHTML = format(date) } }, format } } })();